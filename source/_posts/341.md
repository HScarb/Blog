---
title: Django Nginx uWSGI 配置
author: Scarb
postid: 341
posttype: post
categories: exp
toc: true
date: 2018-11-05 00:33:05
updated: 2018-11-05 00:33:05
nicename:
tags:
---

>本文由Scarb发表于[金甲虫的博客](http://47.106.131.90/blog)，转载请注明出处

# Django Nginx uWSGI 配置

## 1. Django

前置准备：
部署好python环境
在机器上安装django，并创建一个django项目。
django项目的创建可见[django 官方教程笔记](http://www.cnscarb.com/blog/post/328.html)

创建完之后运行测试

```shell
python manage.py runserver 0.0.0.0:8000
```

访问8000端口可以看到django项目成功启动

<!-- more -->

## 2. uWSGI

### 2.1 概念和原理

> WSGI（Python Web Server GateWay Interface）: WSGI是一种Web服务器网关接口。它是一个Web服务器（如nginx）与应用服务器（如uWSGI服务器）通信的一种规范。由于WSGI的通用性，出现了独立的WSGI程序，例如uWSGI和Apacke的mod_wsgi。

> uWSGI: 是一个Web服务器，它实现了WSGI协议、uwsgi、http等协议。用于接收前端服务器转发的动态请求并处理后发给 web 应用程序。

> uwsgi: 是uWSGI服务器实现的独有的协议。

#### nginx/uWSGI/Django项目工作流程
1. 用户通过浏览器发出http请求到服务器。
2. nginx负责接受外部http请求并进行解包，若请求是静态文件则根据设置好的静态文件路径返回对应内容。若请求是动态内容则将请求交给uWSGI服务器（nginx和uWSGI使用端口或socket通信）。
3. uWSGI服务器收到请求后，根据wsgi协议解析并回调Django应用。
4. Django应用则根据请求进行数据库增删查改和模版渲染等工作，然后再逆方向返回nginx。
5. nginx将响应交付用户浏览器。

## 2.2 安装和配置uWSGI

用pip安装uwsgi

```shell
pip install uwsgi
```

装完之后测试一下，创建`test.py`

```python
# test.py
def application(env, start_response):
    start_response('200 OK', [('Content-Type','text/html')])
    return [b"Hello World"] # python3
    #return ["Hello World"] # python2
```

然后用uWSGI运行刚才创建的简单web app

```shell
uwsgi --http :8000 --wsgi-file test.py
```

访问8000端口可以看到Hello World

接下来在我们的Django项目上使用uWSGI

```shell
uwsgi --http :8000 --module mysite.wsgi
# module mysite.wsgi: 加载指定的wsgi模块
```

## 3. nginx

## 参考资料

1. [uWSGI+django+nginx的工作原理流程与部署历程](https://blog.csdn.net/c465869935/article/details/53242126)
2. [Django + Uwsgi + Nginx 的生产环境部署](https://www.cnblogs.com/chenice/p/6921727.html)
3. [django+nginx+uwsgi部署完全指导](https://blog.csdn.net/eightbrother888/article/details/79503716)
4. [Django Nginx+uwsgi 安装配置](http://www.runoob.com/django/django-nginx-uwsgi.html)
5. [从零开始搭建个人网站（6）nginx+uWSGI部署Django项目（上）](https://blog.csdn.net/zuimrs/article/details/79091518)
6. [How to use Django with uWSGI](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/uwsgi/)
7. [Setting up Django and your web server with uWSGI and nginx](https://uwsgi-docs.readthedocs.io/en/latest/tutorials/Django_and_nginx.html)